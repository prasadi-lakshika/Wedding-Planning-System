<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard - Wedding Planning System</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <header>
    <div class="navbar">
      <nav>
        <a href="dashboard.html">Dashboard</a>
        <a href="client_management.html">Client Management</a>
        <a href="admin_dashboard.html" class="active">Admin Dashboard</a>
        <a href="profile.html">Profile</a>
      </nav>
      <button class="login-btn" id="logoutBtn">Logout</button>
    </div>
  </header>
  <main class="main-content">
    <h2>Admin Dashboard</h2>
    <section id="userManagementSection">
      <h3>User Management</h3>
      <form id="addUserForm">
        <label for="newUserEmail">Email:</label>
        <input type="email" id="newUserEmail" required />
        <label for="newUserBusinessName">Business Name:</label>
        <input type="text" id="newUserBusinessName" required />
        <label for="newUserPassword">Password:</label>
        <input type="password" id="newUserPassword" required minlength="6" />
        <label for="newUserRole">Role:</label>
        <select id="newUserRole" required>
          <option value="planner">Planner</option>
          <option value="admin">Admin</option>
        </select>
        <button type="submit">Add User</button>
      </form>
      <div id="userListContainer" style="margin-top: 20px;">
        <h4>Existing Users</h4>
        <table id="userListTable">
          <thead>
            <tr>
              <th>Email</th>
              <th>Business Name</th>
              <th>Role</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="userListBody">
            <!-- User rows will be populated here -->
          </tbody>
        </table>
      </div>
    </section>
  </main>
  <footer>&copy; 2025 Wedding Planning System</footer>
  <script>
    // Load users from localStorage
    function loadUsers() {
      const users = JSON.parse(localStorage.getItem('weddingPlanners')) || [];
      const tbody = document.getElementById('userListBody');
      tbody.innerHTML = '';
      users.forEach((user, index) => {
        const tr = document.createElement('tr');
        tr.innerHTML = '<td>' + user.email + '</td>' +
                       '<td>' + user.businessName + '</td>' +
                       '<td>' + (user.role || 'planner') + '</td>' +
                       '<td><button onclick="deleteUser(' + index + ')">Delete</button></td>';
        tbody.appendChild(tr);
      });
    }

    // Add new user
    document.getElementById('addUserForm').addEventListener('submit', function(e) {
      e.preventDefault();
      const email = document.getElementById('newUserEmail').value.trim();
      const businessName = document.getElementById('newUserBusinessName').value.trim();
      const password = document.getElementById('newUserPassword').value;
      const role = document.getElementById('newUserRole').value;

      if (!email || !businessName || !password || !role) {
        alert('Please fill in all fields.');
        return;
      }

      let users = JSON.parse(localStorage.getItem('weddingPlanners')) || [];
      if (users.find(u => u.email === email)) {
        alert('User with this email already exists.');
        return;
      }

      users.push({ email: email, businessName: businessName, password: password, role: role });
      localStorage.setItem('weddingPlanners', JSON.stringify(users));
      alert('User added successfully.');
      this.reset();
      loadUsers();
    });

    // Delete user
    function deleteUser(index) {
      let users = JSON.parse(localStorage.getItem('weddingPlanners')) || [];
      if (index >= 0 && index < users.length) {
        if (confirm('Are you sure you want to delete this user?')) {
          users.splice(index, 1);
          localStorage.setItem('weddingPlanners', JSON.stringify(users));
          loadUsers();
        }
      }
    }

    // Logout button
    document.getElementById('logoutBtn').addEventListener('click', function() {
      localStorage.removeItem('userRole');
      location.href = 'dashboard.html';
    });

    // Initial load
    loadUsers();
  </script>
</body>
</html>
