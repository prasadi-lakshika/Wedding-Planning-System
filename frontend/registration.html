<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Planner Registration - Wedding Planning System</title>
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <header>
    <div class="navbar">
      <nav id="mainNav">
        <!-- Only show Home link for non-authenticated users -->
        <a href="index.html" class="nav-link">Home</a>
      </nav>
      <button class="login-btn" id="openLogin">Sign In / Log In</button>
    </div>
  </header>
  
  <main class="main-content">
    <form class="registration-form" id="registrationForm">
      <h2>Planner Registration</h2>
      <div class="error-msg" id="errorMsg" style="color:red; margin-bottom:10px;"></div>
      <div class="success-msg" id="successMsg" style="color:green; margin-bottom:10px;"></div>
      <label for="businessName">Business Name</label>
      <input type="text" id="businessName" name="businessName" placeholder="Your Business Name" required />
      <label for="email">Email</label>
      <input type="email" id="email" name="email" placeholder="Your Email" required />
      <label for="password">Password</label>
      <input type="password" id="password" name="password" placeholder="Password" required minlength="6" />
      <label for="confirmPassword">Confirm Password</label>
      <input type="password" id="confirmPassword" name="confirmPassword" placeholder="Confirm Password" required minlength="6" />
      <button type="submit">Register</button>
    </form>
    <p style="text-align: center; margin-top: 20px;">
      Already have an account? <a href="index.html">Sign in here</a>
    </p>
  </main>
  
  <footer>&copy; 2025 Wedding Planning System</footer>
  
  <!-- Modal Background -->
  <div class="modal-bg" id="modalBG"></div>
  <!-- Login Modal -->
  <div class="modal" id="loginModal">
    <span class="close-x" onclick="closeModal()">&times;</span>
    <h3 style="margin-top:2px;">Login to your account</h3>
    <form id="emailLoginForm">
      <input id="loginEmail" type="email" placeholder="Email" required>
      <input id="loginPassword" type="password" placeholder="Password" required>
      <button type="submit" class="login-btn" style="width:100%; margin-bottom:15px;">Login</button>
      <div id="loginMsg" style="color:red; font-size:0.98em; margin-bottom:9px;"></div>
    </form>
  </div>
  
  <!-- Load JavaScript files -->
  <script src="assets/js/login_modal.js"></script>
  <script>
    const registrationForm = document.getElementById('registrationForm');
    const errorMsg = document.getElementById('errorMsg');
    const successMsg = document.getElementById('successMsg');

    registrationForm.addEventListener('submit', function(event) {
      event.preventDefault();
      errorMsg.textContent = '';
      successMsg.textContent = '';

      const businessName = registrationForm.businessName.value.trim();
      const email = registrationForm.email.value.trim();
      const password = registrationForm.password.value;
      const confirmPassword = registrationForm.confirmPassword.value;

      if (!businessName || !email || !password || !confirmPassword) {
        errorMsg.textContent = 'Please fill in all fields.';
        return;
      }

      if (password !== confirmPassword) {
        errorMsg.textContent = 'Passwords do not match.';
        return;
      }

      // Check if user already exists in localStorage
      let users = JSON.parse(localStorage.getItem('weddingPlanners')) || [];
      if (users.find(user => user.email === email)) {
        errorMsg.textContent = 'An account with this email already exists.';
        return;
      }

      // Save new user with default role 'planner'
      users.push({ businessName, email, password, role: 'planner' });
      localStorage.setItem('weddingPlanners', JSON.stringify(users));

      successMsg.textContent = 'Registration successful! You can now log in.';
      registrationForm.reset();
      
      // Redirect to home page after 2 seconds
      setTimeout(() => {
        window.location.href = 'index.html';
      }, 2000);
    });
  </script>
</body>
</html>